# 18.01.2019 eheidt : bash rules!
# 06.03.2019 florian : 

# $1 left text
# $2 right text
# $3 svg image base64
# $4 right color

if [ "$2" = "" ]; then 
  echo usage: badgen.sh NAME VALUE [ImagePath] [Color] 1>&2
  exit 0
fi

KEY=$1
VALUE=$2
KEY_LEN=$((${#KEY}*75))
VALUE_LEN=$((${#VALUE}*75))

LEFT=$(($KEY_LEN+250))
RIGHT=$(($VALUE_LEN+250))
LEN=$(($LEFT+$RIGHT)) # 230.5
LEN2=$(($LEN/10))            # 2305 

IMG=${3:-"DEFAULT"}

if [ -f "$IMG" ]; then 
  IMAGE="data:image/svg+xml;base64,$(cat "$IMG" | base64)"
else
  IMAGE="data:image/png;base64,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"
fi

COLOR=${4:-"#3C1"}

cat <<EOF
<svg width="$LEN2" height="20" viewBox="0 0 $LEN 200" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <linearGradient id="a" x2="0" y2="100%">
    <stop offset="0" stop-opacity=".1" stop-color="#EEE"/>
    <stop offset="1" stop-opacity=".1"/>
  </linearGradient>
  <mask id="m"><rect width="$LEN" height="200" rx="30" fill="#FFF"/></mask>
  <g mask="url(#m)">
    <rect width="$LEFT" height="200" fill="#555"/>
    <rect width="$RIGHT" height="200" fill="$COLOR" x="$LEFT"/>
    <rect width="$LEN" height="200" fill="url(#a)"/>
  </g>
  <g fill="#fff" text-anchor="start" font-family="Verdana,DejaVu Sans,sans-serif" font-size="110">
    <text x="220" y="148" textLength="$KEY_LEN" fill="#000" opacity="0.25">$KEY</text>
    <text x="210" y="138" textLength="$KEY_LEN">$KEY</text>
    <text x="$(($LEFT+100))" y="148" textLength="$VALUE_LEN" fill="#000" opacity="0.25">$VALUE</text>
    <text x="$(($LEFT+100))" y="138" textLength="$VALUE_LEN">$VALUE</text>
  </g>
  <image x="40" y="35" width="130" height="130" xlink:href="$IMAGE"/>
</svg>
EOF
