# 18.01.2019 eheidt : bash rules!
# 06.03.2019 florian : 

# $1 left text
# $2 right text
# $3 svg image base64
# $4 right color

if [ "$2" = "" ]; then 
  echo usage: badgen.sh NAME VALUE [ImagePath] [Color] 1>&2
  exit 0
fi

KEY=$1
VALUE=$2
KEY_LEN=$((${#KEY}*75))
VALUE_LEN=$((${#VALUE}*75))

LEFT=$(($KEY_LEN+250))
RIGHT=$(($VALUE_LEN+250))
LEN=$(($LEFT+$RIGHT)) # 230.5
LEN2=$(($LEN/10))            # 2305 

IMG=${3:-"DEFAULT"}

if [ -f "$IMG" ]; then 
  IMAGE="data:image/svg+xml;base64,$(cat "$IMG" | base64)"
else
  IMAGE="data:image/png;base64,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"
fi

COLOR=${4:-"#3C1"}

cat <<EOF
<svg width="$LEN2" height="20" viewBox="0 0 $LEN 200" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <linearGradient id="a" x2="0" y2="100%">
    <stop offset="0" stop-opacity=".1" stop-color="#EEE"/>
    <stop offset="1" stop-opacity=".1"/>
  </linearGradient>
  <mask id="m"><rect width="$LEN" height="200" rx="30" fill="#FFF"/></mask>
  <g mask="url(#m)">
    <rect width="$LEFT" height="200" fill="#555"/>
    <rect width="$RIGHT" height="200" fill="$COLOR" x="$LEFT"/>
    <rect width="$LEN" height="200" fill="url(#a)"/>
  </g>
  <g fill="#fff" text-anchor="start" font-family="Verdana,DejaVu Sans,sans-serif" font-size="110">
    <text x="220" y="148" textLength="$KEY_LEN" fill="#000" opacity="0.25">$KEY</text>
    <text x="210" y="138" textLength="$KEY_LEN">$KEY</text>
    <text x="$(($LEFT+100))" y="148" textLength="$VALUE_LEN" fill="#000" opacity="0.25">$VALUE</text>
    <text x="$(($LEFT+100))" y="138" textLength="$VALUE_LEN">$VALUE</text>
  </g>
  <image x="40" y="35" width="130" height="130" xlink:href="$IMAGE"/>
</svg>
EOF
